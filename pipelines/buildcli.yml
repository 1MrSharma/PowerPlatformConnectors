pool:
  vmImage: 'windows-latest'

steps:
- task: ComponentGovernanceComponentDetection@0
  inputs:
    scanType: 'Register'
    verbosity: 'Verbose'
    alertWarningLevel: 'High'
- task: "ea576cd4-c61f-48f8-97e7-a3cb07b90a6f@2"
  inputs:
    toolMajorVersion: 'V2'
- task: PowerShell@1
  displayName: 'PowerShell Script'
  inputs:
    scriptName: Security.CredScanAutomation/SecretsScan.ps1
    arguments: '-limitRepos 0'
    failOnStandardError: false
  continueOnError: true
- task: PowerShell@1
  displayName: 'PowerShell Script'
  inputs:
    scriptName: Security.CredScanAutomation/ParseSecretsScanResults.ps1
    arguments: '-logsOutput "$(Agent.BuildDirectory)\_sdt\logs\CredentialScanner"'
  continueOnError: true
- task: PublishSecurityAnalysisLogs@3
  inputs:
    ArtifactName: 'CodeAnalysisLogs'
    ArtifactType: 'Container'